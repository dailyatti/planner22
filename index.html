<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Cherry Digital Planner ‚Äì modular 2025 planner with mood, water, notes, PhD-level cycle tracker, PDF/PNG export & autosave." />
  <meta name="theme-color" content="#FDE6F1" />
  <title>Cherry Digital Planner üçí ‚Äì Modular</title>

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&family=Pacifico&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />

  <!-- Export libs -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>

  <link rel="stylesheet" href="assets/css/cherry.css" />
</head>
<body>
  <div id="navBackdrop" class="backdrop" hidden></div>
  <nav class="navbar" role="navigation" aria-label="Main navigation">
    <div class="nav-inner">
      <div class="brand">
        <div class="logo">üçí</div>
        <div class="brand-title">Cherry Planner</div>
      </div>
      <div class="spacer"></div>
      <button id="navToggle" class="nav-toggle" aria-expanded="false" aria-controls="menu">
        <i class="fa-solid fa-bars"></i><span style="margin-left:6px">Menu</span>
      </button>
      <div id="menu" class="menu" role="menu" aria-hidden="true">
        <div class="menu-grid">
          <button class="btn" id="btnPdf" type="button" aria-label="Save as PDF"><i class="fa-solid fa-file-pdf"></i><span>PDF</span></button>
          <button class="btn" id="btnPng" type="button" aria-label="Save as image"><i class="fa-solid fa-image"></i><span>Image</span></button>
          <button class="btn" id="btnPrint" type="button" aria-label="Print"><i class="fa-solid fa-print"></i><span>Print</span></button>
          <button class="btn" id="btnSave" type="button" aria-label="Save"><i class="fa-solid fa-floppy-disk"></i><span>Save</span></button>
          <button class="btn" id="btnReset" type="button" aria-label="Reset"><i class="fa-solid fa-rotate"></i><span>Reset (today)</span></button>
          <button class="btn" id="btnResetAll" type="button" aria-label="Reset all"><i class="fa-solid fa-broom"></i><span>Reset (all)</span></button>

        </div>
      </div>
    </div>
  </nav>

  <div class="page">
    <main class="container" id="plannerContent">
      <header class="header">
        <h1>
          <span class="cherry left">üçí</span>
          My Cherry Planner
          <span class="cherry right">üçí</span>
        </h1>
        <p>Plan your perfect day with style!</p>
      </header>

      <section class="date-selector" aria-label="Select date">
        <label for="plannerDate">Date:</label>
        <input type="date" id="plannerDate" />
        <strong id="dayOfWeek" aria-live="polite"></strong>
      </section>

      <section class="planner-grid" aria-label="Planner">
        <!-- Todos -->
        <article class="card" aria-labelledby="h-todos">
          <h2 id="h-todos" class="card-title">üìù Daily Tasks</h2>
          <ul id="todoList" class="todo-list"></ul>
          <button class="btn" id="addTodo" type="button"><i class="fa-solid fa-plus"></i><span>Add task</span></button>
        </article>

        <!-- Priorities -->
        <article class="card" aria-labelledby="h-prio">
          <h2 id="h-prio" class="card-title">‚≠ê Top 3 Priorities</h2>
          <div class="slot"><label for="prio1">#1 priority</label><input id="prio1" data-key="prio1" placeholder="Most important task" /></div>
          <div style="margin-top:-6px;margin-bottom:8px"><span class="tag high">High</span></div>
          <div class="slot"><label for="prio2">#2 priority</label><input id="prio2" data-key="prio2" placeholder="Second most important task" /></div>
          <div style="margin-top:-6px;margin-bottom:8px"><span class="tag medium">Medium</span></div>
          <div class="slot"><label for="prio3">#3 priority</label><input id="prio3" data-key="prio3" placeholder="Third most important task" /></div>
          <div style="margin-top:-6px"><span class="tag low">Low</span></div>
        </article>

        <!-- Schedule -->
        <article class="card" aria-labelledby="h-time">
          <h2 id="h-time" class="card-title">‚è∞ Schedule</h2>
          <div class="slot"><label for="morn">Morning (6:00‚Äì12:00)</label><input id="morn" data-key="time_morning" placeholder="Morning routine, breakfast‚Ä¶" /></div>
          <div class="slot"><label for="noon">Afternoon (12:00‚Äì18:00)</label><input id="noon" data-key="time_noon" placeholder="Work, lunch‚Ä¶" /></div>
          <div class="slot"><label for="eve">Evening (18:00‚Äì22:00)</label><input id="eve" data-key="time_evening" placeholder="Dinner, relaxation‚Ä¶" /></div>
        </article>

        <!-- Meals -->
        <article class="card" aria-labelledby="h-meal">
          <h2 id="h-meal" class="card-title">üçì Meals</h2>
          <div class="slot"><label for="meal_b">Breakfast</label><input id="meal_b" data-key="meal_breakfast" placeholder="What will I have for breakfast?" /></div>
          <div class="slot"><label for="meal_l">Lunch</label><input id="meal_l" data-key="meal_lunch" placeholder="What will I have for lunch?" /></div>
          <div class="slot"><label for="meal_d">Dinner</label><input id="meal_d" data-key="meal_dinner" placeholder="What will I have for dinner?" /></div>
          <div class="slot"><label for="meal_s">Snacks</label><input id="meal_s" data-key="meal_snacks" placeholder="Healthy snacks" /></div>
        </article>

        <!-- Water -->
        <article class="card" aria-labelledby="h-water">
          <h2 id="h-water" class="card-title">üíß Water Tracker</h2>
          <div class="water-wrap">
            <div class="water-controls">
              <div class="field"><label for="waterTarget">Goal</label><button id="decTarget" title="-1" aria-label="Decrease goal">‚àí</button><input id="waterTarget" type="number" min="1" max="24" step="1" value="8" aria-label="Daily water goal in glasses" /><button id="incTarget" title="+1" aria-label="Increase goal">+</button></div>
              <div class="field tight"><label for="waterCount">Drank</label><button id="decWater" title="-1" aria-label="Decrease water">‚àí</button><input id="waterCount" type="number" min="0" max="24" step="1" value="0" aria-label="Glasses consumed" /><button id="incWater" title="+1" aria-label="Increase water">+</button></div>
            </div>
            <div class="water" id="water" role="group" aria-label="Water Tracker"></div>
            <div class="water-progress" aria-hidden="true"><span id="waterBar"></span></div>
            <div class="water-meta"><span id="waterSummary">0 / 8 glasses</span><span style="margin:0 6px">¬∑</span><span id="waterStats">0 of 8 glasses consumed</span></div>
          </div>
        </article>

        <!-- Mood -->
        <article class="card" aria-labelledby="h-mood">
          <h2 id="h-mood" class="card-title">üí≠ Today's Mood</h2>
          <p style="text-align:center;color:var(--muted);margin-bottom:8px">Rate each mood separately (1-10)</p>
          <div class="mood-wrap">
            <div id="moodMultiSliders" class="mood-multi-sliders"></div>
            <div class="slot"><label for="moodNotes">What influences your mood?</label><textarea id="moodNotes" class="mood-notes" data-key="moodNotes" placeholder="Thoughts, energy, triggers‚Ä¶"></textarea></div>
            <button id="motivationBtn" class="btn motivation-btn" onclick="showCycleBasedMotivation()">
              <i class="fa-solid fa-heart"></i><span>Get Motivated</span>
            </button>
          </div>
        </article>

        <!-- Gratitude -->
        <article class="card" aria-labelledby="h-grat">
          <h2 id="h-grat" class="card-title">üå∏ Gratitude</h2>
          <div class="slot"><label for="grat1">1.</label><input id="grat1" data-key="grat1" placeholder="I am grateful for‚Ä¶" /></div>
          <div class="slot"><label for="grat2">2.</label><input id="grat2" data-key="grat2" placeholder="I am grateful for‚Ä¶" /></div>
          <div class="slot"><label for="grat3">3.</label><input id="grat3" data-key="grat3" placeholder="I am grateful for‚Ä¶" /></div>
        </article>

        <!-- Notes -->
        <article class="card full" aria-labelledby="h-notes">
          <h2 id="h-notes" class="card-title">üìî Notes & Ideas</h2>
          <div class="notes-toolbar">
            <button class="tool-btn" data-ins="- [ ] ">Checklist</button>
            <button class="tool-btn" data-ins="‚Ä¢ ">Bullet</button>
            <button class="tool-btn" data-ins="# ">Heading</button>
            <button class="tool-btn" data-format="**">Bold</button>
            <button class="tool-btn" id="exportTxt">Export .txt</button>
            <span class="notes-meta" id="notesMeta" style="margin-left:auto"></span>
          </div>
          <textarea id="notes" class="notes-area" placeholder="Write your thoughts, ideas and notes here‚Ä¶"></textarea>
        </article>

        <!-- Cycle Tracker -->
        <article class="card full" aria-labelledby="h-cycle">
          <h2 id="h-cycle" class="card-title">üåô Cycle Tracker (Estimation)</h2>
          <div class="cycle-grid">
            <div class="cycle-controls">
              <div class="field"><label for="cycleStart">Last start</label><input id="cycleStart" type="date" /></div>
              <div class="field"><label for="cycleLen">Cycle</label><input id="cycleLen" type="number" min="20" max="40" step="1" value="28" /> days</div>
              <div class="field"><label for="periodLen">Period</label><input id="periodLen" type="number" min="1" max="10" step="1" value="5" /> days</div>
              <div class="field"><label for="lutealLen">Luteal</label><input id="lutealLen" type="number" min="8" max="18" step="1" value="14" /> days</div>
              <div class="field"><label for="advEst">Advanced</label><input id="advEst" type="checkbox" checked /> estimation</div>
              <button id="saveCycle" class="btn" type="button"><i class="fa-solid fa-floppy-disk"></i><span>Save</span></button>
              <button id="exportCycle" class="btn" type="button" aria-label="Export cycle data"><i class="fa-solid fa-file-export"></i><span>Export</span></button>
              <button id="clearCycle" class="btn" type="button" aria-label="Clear cycle history" style="background:linear-gradient(135deg,#ff9bb3,#ff6b6b)"><i class="fa-solid fa-broom"></i><span>Clear history</span></button>
            </div>
            <div id="cycleSummary" class="slot" aria-live="polite" style="display:flex;gap:14px;flex-wrap:wrap;align-items:center;justify-content:space-between">
              <div><strong>Next period (‚âà):</strong> <span id="nextPeriod">‚Äì</span> ‚Ä¢ <strong>Ovulation (‚âà):</strong> <span id="nextOvul">‚Äì</span></div>
              <div style="color:var(--muted)"><span id="avgLen">Avg cycle: ‚Äì</span> ‚Ä¢ <span id="avgPeriod">Avg period: ‚Äì</span> ‚Ä¢ <span id="samples">Samples: 0</span> ‚Ä¢ <span id="confRange">Confidence: ‚Äì</span> ‚Ä¢ <span id="irreg">Irregularity: ‚Äì</span></div>
            </div>
            
            <!-- Enhanced Cycle Predictions Display -->
            <div id="cyclePredictions" class="cycle-predictions" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin: 20px 0; padding: 20px; background: linear-gradient(135deg, #fff5f7, #ffe7ee); border-radius: 16px; border: 1px solid #ffc6d7;">
              <!-- Predictions will be populated by JavaScript -->
            </div>
            <div class="cycle-calendar">
              <div class="cal-head">
                <button class="tool-btn" id="calPrev" aria-label="Previous month">‚óÄ</button>
                <strong id="calTitle"></strong>
                <button class="tool-btn" id="calNext" aria-label="Next month">‚ñ∂</button>
              </div>
              <div class="cal-grid" id="calGrid"></div>
              <div class="legend">
                <span><i class="chip-sm" style="background:#ffe7ee;border:1px solid #ffc6d7"></i> Period</span>
                <span><i class="chip-sm" style="background:#e6fff5;border:1px solid #bff0dc"></i> Fertile</span>
                <span><i class="chip-sm" style="background:#fff9d9;border:1px solid #ffeaa1"></i> Ovulation (‚âà)</span>
                <span><i class="chip-sm" style="background:var(--primary)"></i> Actual start</span>
              </div>
              <small style="display:block;margin-top:8px;color:var(--muted)">Estimation only ‚Äì not a medical tool. Click: toggle actual start ‚Ä¢ Shift+Click: toggle a period day.</small>
            </div>
          </div>
        </article>
      </section>

      <footer class="footer" aria-label="Footer">
        <p>Made with üíï ‚Äì Cherry Digital Planner ¬© 2025</p>
      </footer>
    </main>
  </div>



  <div id="toast" class="toast" role="status" aria-live="polite">Saved successfully!</div>

  <script type="module" src="assets/js/main.js"></script>
  
  <!-- Motivation System & Enhanced Cycle Tracker -->
  <script>
    // Motivation System
    const motivationData = {
      quotes: [
        "Every day is a new beginning. Take a deep breath and start again.",
        "You are capable of amazing things. Believe in yourself.",
        "Progress is progress, no matter how small.",
        "Your strength is greater than any struggle.",
        "Today is your day to shine.",
        "You have the power to create change.",
        "Every step forward is a victory.",
        "Your potential is limitless.",
        "You are stronger than you think.",
        "Keep going, you're doing great!",
        "Success is not final, failure is not fatal.",
        "The only way to do great work is to love what you do.",
        "Believe you can and you're halfway there.",
        "Don't watch the clock; do what it does. Keep going.",
        "The future depends on what you do today.",
        "You miss 100% of the shots you don't take.",
        "Life is 10% what happens to you and 90% how you react to it.",
        "The best way to predict the future is to create it.",
        "Your attitude determines your direction.",
        "Dream big and dare to fail.",
        "Every expert was once a beginner.",
        "The journey of a thousand miles begins with one step.",
        "You are never too old to set another goal.",
        "Success is walking from failure to failure.",
        "The only limit to your impact is your imagination.",
        "What you get by achieving your goals is not as important as what you become.",
        "The harder you work for something, the greater you'll feel when you achieve it.",
        "Don't limit your challenges. Challenge your limits.",
        "Your time is limited, don't waste it living someone else's life.",
        "The only person you are destined to become is the person you decide to be.",
        "Life is what happens when you're busy making other plans.",
        "The greatest glory in living lies not in never falling, but in rising every time we fall.",
        "In the middle of difficulty lies opportunity.",
        "The way to get started is to quit talking and begin doing.",
        "It does not matter how slowly you go as long as you do not stop.",
        "The only impossible journey is the one you never begin.",
        "You are the only one who can limit your greatness.",
        "The best revenge is massive success.",
        "Don't be afraid to give up the good to go for the great.",
        "The difference between ordinary and extraordinary is that little extra.",
        "Your life does not get better by chance, it gets better by change.",
        "The only way to achieve the impossible is to believe it is possible.",
        "Success is not the key to happiness. Happiness is the key to success.",
        "The greatest wealth is health.",
        "The mind is everything. What you think you become.",
        "The only true wisdom is in knowing you know nothing.",
        "The journey is the reward.",
        "The best preparation for tomorrow is doing your best today.",
        "The only person you should try to be better than is the person you were yesterday.",
        "Your dreams don't have an expiration date. Take a deep breath and try again.",
        "The only limit to our realization of tomorrow will be our doubts of today."
      ],
      psalms: [
        "The Lord is my shepherd, I shall not want. He makes me lie down in green pastures, he leads me beside quiet waters, he refreshes my soul.",
        "I lift up my eyes to the mountains‚Äîwhere does my help come from? My help comes from the Lord, the Maker of heaven and earth.",
        "The Lord is my light and my salvation‚Äîwhom shall I fear? The Lord is the stronghold of my life‚Äîof whom shall I be afraid?",
        "Be strong and courageous. Do not be afraid; do not be discouraged, for the Lord your God will be with you wherever you go.",
        "I can do all this through him who gives me strength.",
        "For I know the plans I have for you, declares the Lord, plans to prosper you and not to harm you, plans to give you hope and a future.",
        "Come to me, all you who are weary and burdened, and I will give you rest.",
        "Trust in the Lord with all your heart and lean not on your own understanding; in all your ways submit to him, and he will make your paths straight.",
        "The Lord is close to the brokenhearted and saves those who are crushed in spirit.",
        "Cast your cares on the Lord and he will sustain you; he will never let the righteous be shaken."
      ],
      tips: [
        "Take deep breaths when feeling overwhelmed. Inhale for 4 counts, hold for 4, exhale for 4.",
        "Break large tasks into smaller, manageable steps. Celebrate each small victory.",
        "Practice gratitude by writing down 3 things you're thankful for each day.",
        "Stay hydrated - even mild dehydration can affect your mood and energy.",
        "Move your body daily, even if it's just a short walk around the block.",
        "Connect with loved ones regularly. Social support is crucial for mental health.",
        "Limit screen time before bed to improve sleep quality.",
        "Practice self-compassion. Treat yourself as you would treat a good friend.",
        "Learn to say no to things that don't align with your priorities.",
        "Create a morning routine that sets a positive tone for your day.",
        "Keep a journal to process your thoughts and feelings.",
        "Learn something new every day, no matter how small.",
        "Practice mindfulness by being fully present in the moment.",
        "Set boundaries to protect your time and energy.",
        "Remember that it's okay to ask for help when you need it.",
        "Focus on progress, not perfection.",
        "Take regular breaks throughout the day to recharge.",
        "Practice positive self-talk and challenge negative thoughts.",
        "Surround yourself with people who lift you up.",
        "Remember that every day is a fresh start."
      ]
    };

    // Enhanced Cycle Tracker with Fertility Predictions
    function updateCyclePredictions() {
      const cycleData = JSON.parse(localStorage.getItem('cherry::cycle') || '{}');
      const today = new Date();
      
      if (cycleData.lastPeriod && cycleData.cycleLength) {
        const lastPeriod = new Date(cycleData.lastPeriod);
        const cycleLength = parseInt(cycleData.cycleLength);
        const periodDuration = parseInt(cycleData.periodDuration) || 5;
        
        // Calculate next period
        const nextPeriod = new Date(lastPeriod);
        nextPeriod.setDate(lastPeriod.getDate() + cycleLength);
        
        // Calculate fertile window (5 days before ovulation + ovulation day)
        const ovulationDay = new Date(lastPeriod);
        ovulationDay.setDate(lastPeriod.getDate() + (cycleLength - 14));
        const fertileStart = new Date(ovulationDay);
        fertileStart.setDate(ovulationDay.getDate() - 5);
        const fertileEnd = new Date(ovulationDay);
        fertileEnd.setDate(ovulationDay.getDate() + 1);
        
        // Update display
        const predictionsDiv = document.getElementById('cyclePredictions');
        if (predictionsDiv) {
          predictionsDiv.innerHTML = `
            <div class="prediction-card">
              <h4>üìÖ Next Period</h4>
              <p class="prediction-date">${nextPeriod.toLocaleDateString()}</p>
              <p class="prediction-info">${Math.ceil((nextPeriod - today) / (1000 * 60 * 60 * 24))} days away</p>
            </div>
            <div class="prediction-card">
              <h4>ü•ö Fertile Window</h4>
              <p class="prediction-date">${fertileStart.toLocaleDateString()} - ${fertileEnd.toLocaleDateString()}</p>
              <p class="prediction-info">Peak: ${ovulationDay.toLocaleDateString()}</p>
            </div>
            <div class="prediction-card">
              <h4>üìä Current Phase</h4>
              <p class="prediction-date">${getCurrentPhase(today, lastPeriod, cycleLength)}</p>
              <p class="prediction-info">${getPhaseDescription(today, lastPeriod, cycleLength)}</p>
            </div>
          `;
        }
      }
    }

    function getCurrentPhase(today, lastPeriod, cycleLength) {
      const daysSincePeriod = Math.floor((today - lastPeriod) / (1000 * 60 * 60 * 24));
      const cycleDay = daysSincePeriod % cycleLength;
      
      if (cycleDay <= 5) return "Menstrual Phase";
      if (cycleDay <= 14) return "Follicular Phase";
      if (cycleDay <= 16) return "Ovulation Phase";
      return "Luteal Phase";
    }

    function getPhaseDescription(today, lastPeriod, cycleLength) {
      const daysSincePeriod = Math.floor((today - lastPeriod) / (1000 * 60 * 60 * 24));
      const cycleDay = daysSincePeriod % cycleLength;
      
      if (cycleDay <= 5) return "Rest and recovery time";
      if (cycleDay <= 14) return "Building energy and creativity";
      if (cycleDay <= 16) return "Peak fertility and vitality";
      return "Preparing for next cycle";
    }

    // Show motivation based on cycle phase
    function showCycleBasedMotivation() {
      const cycleData = JSON.parse(localStorage.getItem('cherry::cycle') || '{}');
      if (!cycleData.lastPeriod || !cycleData.cycleLength) return;
      
      const today = new Date();
      const lastPeriod = new Date(cycleData.lastPeriod);
      const cycleLength = parseInt(cycleData.cycleLength);
      const daysSincePeriod = Math.floor((today - lastPeriod) / (1000 * 60 * 60 * 24));
      const cycleDay = daysSincePeriod % cycleLength;
      
      let motivationType = 'quote';
      let message = '';
      
      if (cycleDay <= 5) {
        // Menstrual phase - gentle, supportive
        motivationType = 'tip';
        message = motivationData.tips[Math.floor(Math.random() * motivationData.tips.length)];
      } else if (cycleDay <= 14) {
        // Follicular phase - energetic, creative
        motivationType = 'quote';
        message = motivationData.quotes[Math.floor(Math.random() * motivationData.quotes.length)];
      } else if (cycleDay <= 16) {
        // Ovulation phase - powerful, confident
        motivationType = 'psalm';
        message = motivationData.psalms[Math.floor(Math.random() * motivationData.psalms.length)];
      } else {
        // Luteal phase - calming, reflective
        motivationType = 'tip';
        message = motivationData.tips[Math.floor(Math.random() * motivationData.tips.length)];
      }
      
      showMotivationToast(message, motivationType);
    }

    function showMotivationToast(message, type) {
      const toast = document.getElementById('toast');
      const icon = type === 'quote' ? 'üí≠' : type === 'psalm' ? 'üôè' : 'üí°';
      toast.textContent = `${icon} ${message}`;
      toast.className = 'toast show';
      
      setTimeout(() => {
        toast.className = 'toast';
      }, 5000);
    }

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', function() {
      // Update cycle predictions
      updateCyclePredictions();
      
      // Show motivation on period days
      setTimeout(showCycleBasedMotivation, 2000);
    });
  </script>
  
  <!-- Cherry Premium Features -->
  <script type="module">
    // Load premium features asynchronously
    import('./assets/cherry-premium/js/premium.js')
      .then(module => {
        console.log('üçí Premium features loaded');
      })
      .catch(error => {
        console.log('Premium features not available:', error.message);
      });
  </script>
</body>
</html>


